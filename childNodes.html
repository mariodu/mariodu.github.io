<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>ChildNodes Test</title>
</head>
<body>
<p>See the source code.</p>
<br/>
Right:
<div id="r-container"></div>

<br />
Wrong(in Safari):
<div id="w-container"></div>

<script>
    var r_parent = document.getElementById('r-container'),
        w_parent = document.getElementById('w-container');

    for(var i = 0; i < 2; i++) {
        var r_dom = document.createElement('div'),
            w_dom = document.createElement('div');
        r_dom.id = i + 1;
        w_dom.id = i + 1;
        r_dom.innerText = 'Node ' + (i + 1);
        w_dom.innerText = 'Node ' + (i + 1);

    	if (!(document.all && !document.addEventListener)) {
    		r_parent.insertBefore(r_dom, r_parent.childNodes.item(i) || null);
            w_parent.insertBefore(w_dom, w_parent.childNodes[i] || null);
        } else {
            //IE8 can't use `item` when childNodes is empty.
            r_parent.insertBefore(r_dom, r_parent.childNodes[i] || null);
            w_parent.insertBefore(w_dom, w_parent.childNodes[i] || null);
        }
    }

    //read is ok.
    alert(r_parent.childNodes.item(1).innerText);
    alert(r_parent.childNodes[1].innerText);
</script>

</body>
</html>
